{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../components/BreachTimelineExplorer.tsx","../../../../lib/datetime.ts","../../../../components/IncidentForm.tsx","../../../../lib/hooks.ts","../../../../components/TimelineResults.tsx","../../../../lib/rules.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","// ===============================================\r\n// components/BreachTimelineExplorer.tsx\r\n// ===============================================\r\n'use client';\r\n\r\nimport { useMemo, useState } from 'react';\r\nimport IncidentForm from './IncidentForm';\r\nimport TimelineResults from './TimelineResults';\r\nimport {\r\n  DEFAULT_INCIDENT_INPUT,\r\n  getMatchedObligations,\r\n  type IncidentInput,\r\n} from '@/lib/rules';\r\n\r\nexport default function BreachTimelineExplorer() {\r\n  const [incident, setIncident] = useState<IncidentInput>(\r\n    DEFAULT_INCIDENT_INPUT,\r\n  );\r\n\r\n  const obligations = useMemo(\r\n    () => getMatchedObligations(incident),\r\n    [incident],\r\n  );\r\n\r\n  return (\r\n    <section className=\"grid gap-6 md:grid-cols-2\">\r\n      <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm\">\r\n        <IncidentForm value={incident} onChange={setIncident} />\r\n      </div>\r\n\r\n      <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm\">\r\n        <TimelineResults obligations={obligations} />\r\n      </div>\r\n    </section>\r\n  );\r\n}","export function addHours(date: Date, hours: number): Date {\r\n  return new Date(date.getTime() + hours * 60 * 60 * 1000);\r\n}\r\n\r\n/** Truncate a Date to the start of the minute (stabilizes SSR vs CSR). */\r\nexport function truncateToMinute(d: Date): Date {\r\n  return new Date(\r\n    d.getFullYear(),\r\n    d.getMonth(),\r\n    d.getDate(),\r\n    d.getHours(),\r\n    d.getMinutes(),\r\n    0,\r\n    0,\r\n  );\r\n}\r\n\r\nexport function formatLocalDateTime(d: Date): string {\r\n  return new Intl.DateTimeFormat(undefined, {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(d);\r\n}\r\n\r\nexport function toLocalDatetimeInputValue(d: Date): string {\r\n  const pad = (n: number) => String(n).padStart(2, '0');\r\n  const yyyy = d.getFullYear();\r\n  const mm = pad(d.getMonth() + 1);\r\n  const dd = pad(d.getDate());\r\n  const hh = pad(d.getHours());\r\n  const mi = pad(d.getMinutes());\r\n  return `${yyyy}-${mm}-${dd}T${hh}:${mi}`;\r\n}\r\n\r\nexport function parseLocalDatetime(s: string): Date {\r\n  // Input like \"2025-12-08T14:30\"\r\n  const [date, time] = s.split('T');\r\n  const [y, m, d] = date.split('-').map(Number);\r\n  const [hh = 0, mm = 0] = (time ?? '00:00').split(':').map(Number);\r\n  // Ensure seconds = 0 for hydration stability.\r\n  return new Date(y, (m ?? 1) - 1, d ?? 1, hh, mm, 0, 0);\r\n}\r\n\r\nexport function humanizeDelta(deadline: Date): { label: string; isOverdue: boolean } {\r\n  const now = Date.now();\r\n  const ms = deadline.getTime() - now;\r\n  const abs = Math.abs(ms);\r\n  const mins = Math.floor(abs / 60000);\r\n  const days = Math.floor(mins / (60 * 24));\r\n  const hours = Math.floor((mins % (60 * 24)) / 60);\r\n  const minutes = mins % 60;\r\n\r\n  const core =\r\n    days > 0\r\n      ? `${days}d ${hours}h ${minutes}m`\r\n      : hours > 0\r\n      ? `${hours}h ${minutes}m`\r\n      : `${minutes}m`;\r\n\r\n  return ms < 0\r\n    ? { label: `Overdue by ${core}`, isOverdue: true }\r\n    : { label: `${core} remaining`, isOverdue: false };\r\n}","// ===============================================\r\n// components/IncidentForm.tsx\r\n// ===============================================\r\n'use client';\r\n\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport type { IncidentInput, IncidentType, Region, DataCategory } from '@/lib/rules';\r\nimport {\r\n  toLocalDatetimeInputValue,\r\n  parseLocalDatetime,\r\n} from '@/lib/datetime';\r\n\r\ntype Props = {\r\n  value: IncidentInput;\r\n  onChange: (next: IncidentInput) => void;\r\n};\r\n\r\nconst INCIDENT_TYPES: { label: string; value: IncidentType }[] = [\r\n  { label: 'Ransomware', value: 'ransomware' },\r\n  { label: 'Lost device', value: 'lost_device' },\r\n  { label: 'Vendor breach', value: 'vendor_breach' },\r\n  { label: 'Phishing', value: 'phishing' },\r\n];\r\n\r\nconst DATA_OPTIONS: { label: string; value: DataCategory }[] = [\r\n  { label: 'Customer PII', value: 'customer_pii' },\r\n  { label: 'Health/PHI', value: 'health_phi' },\r\n  { label: 'Payment data', value: 'payment_data' },\r\n  { label: 'Employee data', value: 'employee_data' },\r\n];\r\n\r\nconst REGION_OPTIONS: { label: string; value: Region }[] = [\r\n  { label: 'EU (GDPR)', value: 'eu' },\r\n  { label: 'California (CCPA/CPRA)', value: 'california' },\r\n  { label: 'New York (NY SHIELD)', value: 'new_york' },\r\n  { label: 'US – Other', value: 'us_other' },\r\n];\r\n\r\nexport default function IncidentForm({ value, onChange }: Props) {\r\n  // Why: Use form-local primitives for inputs that don't map 1:1 to types.\r\n  const [discoveredAtStr, setDiscoveredAtStr] = useState(\r\n    toLocalDatetimeInputValue(value.discoveredAt),\r\n  );\r\n  const [incidentType, setIncidentType] = useState<IncidentType>(\r\n    value.incidentType,\r\n  );\r\n  const [dataCategories, setDataCategories] = useState<Set<DataCategory>>(\r\n    new Set(value.dataCategories),\r\n  );\r\n  const [regions, setRegions] = useState<Set<Region>>(new Set(value.regions));\r\n\r\n  const nextIncident = useMemo<IncidentInput>(\r\n    () => ({\r\n      discoveredAt: parseLocalDatetime(discoveredAtStr),\r\n      incidentType,\r\n      dataCategories: Array.from(dataCategories),\r\n      regions: Array.from(regions),\r\n    }),\r\n    [discoveredAtStr, incidentType, dataCategories, regions],\r\n  );\r\n\r\n  useEffect(() => {\r\n    onChange(nextIncident);\r\n  }, [nextIncident, onChange]);\r\n\r\n  const toggleSet = <T,>(\r\n    setter: React.Dispatch<React.SetStateAction<Set<T>>>,\r\n    current: Set<T>,\r\n    val: T,\r\n  ) => {\r\n    const next = new Set(current);\r\n    if (next.has(val)) next.delete(val);\r\n    else next.add(val);\r\n    setter(next);\r\n  };\r\n\r\n  return (\r\n    <form\r\n      className=\"space-y-6\"\r\n      onSubmit={(e) => {\r\n        e.preventDefault();\r\n        onChange(nextIncident);\r\n      }}\r\n    >\r\n      <div className=\"space-y-2\">\r\n        <label className=\"block text-sm font-medium text-brx-text-heading\">\r\n          Incident discovered at\r\n        </label>\r\n        <input\r\n          type=\"datetime-local\"\r\n          className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-brx-text-heading focus:border-brx-blue focus:outline-none focus:ring-1 focus:ring-brx-blue\"\r\n          value={discoveredAtStr}\r\n          onChange={(e) => setDiscoveredAtStr(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <label className=\"block text-sm font-medium text-brx-text-heading\">Incident type</label>\r\n        <select\r\n          className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-brx-text-heading focus:border-brx-blue focus:outline-none focus:ring-1 focus:ring-brx-blue\"\r\n          value={incidentType}\r\n          onChange={(e) => setIncidentType(e.target.value as IncidentType)}\r\n        >\r\n          {INCIDENT_TYPES.map((opt) => (\r\n            <option key={opt.value} value={opt.value}>\r\n              {opt.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <label className=\"block text-sm font-medium text-brx-text-heading\">Data involved</label>\r\n        <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-2\">\r\n          {DATA_OPTIONS.map((opt) => (\r\n            <label\r\n              key={opt.value}\r\n              className=\"flex cursor-pointer items-center gap-2 rounded-md border border-gray-300 px-3 py-2 text-sm text-brx-text-body transition-colors hover:border-brx-blue\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                className=\"accent-brx-blue\"\r\n                checked={dataCategories.has(opt.value)}\r\n                onChange={() =>\r\n                  toggleSet(setDataCategories, dataCategories, opt.value)\r\n                }\r\n              />\r\n              {opt.label}\r\n            </label>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <label className=\"block text-sm font-medium text-brx-text-heading\">Regions affected</label>\r\n        <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-2\">\r\n          {REGION_OPTIONS.map((opt) => (\r\n            <label\r\n              key={opt.value}\r\n              className=\"flex cursor-pointer items-center gap-2 rounded-md border border-gray-300 px-3 py-2 text-sm text-brx-text-body transition-colors hover:border-brx-blue\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                className=\"accent-brx-blue\"\r\n                checked={regions.has(opt.value)}\r\n                onChange={() => toggleSet(setRegions, regions, opt.value)}\r\n              />\r\n              {opt.label}\r\n            </label>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-end gap-2\">\r\n        <button\r\n          type=\"submit\"\r\n          className=\"rounded-full bg-brx-blue px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-brx-blue-hover\"\r\n        >\r\n          Generate timeline\r\n        </button>\r\n        <span className=\"text-xs text-brx-text-body\">\r\n          Updates automatically on change.\r\n        </span>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nexport function useMounted(): boolean {\r\n  const [mounted, setMounted] = useState(false);\r\n  useEffect(() => setMounted(true), []);\r\n  return mounted;\r\n}\r\n\r\n// lib/datetime.ts\r\nexport function addHours(date: Date, hours: number): Date {\r\n  return new Date(date.getTime() + hours * 60 * 60 * 1000);\r\n}\r\nexport function truncateToMinute(d: Date): Date {\r\n  return new Date(d.getFullYear(), d.getMonth(), d.getDate(), d.getHours(), d.getMinutes(), 0, 0);\r\n}\r\nexport function formatLocalDateTime(d: Date): string {\r\n  return new Intl.DateTimeFormat(undefined, {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(d);\r\n}\r\nexport function toLocalDatetimeInputValue(d: Date): string {\r\n  const pad = (n: number) => String(n).padStart(2, '0');\r\n  const yyyy = d.getFullYear();\r\n  const mm = pad(d.getMonth() + 1);\r\n  const dd = pad(d.getDate());\r\n  const hh = pad(d.getHours());\r\n  const mi = pad(d.getMinutes());\r\n  return `${yyyy}-${mm}-${dd}T${hh}:${mi}`;\r\n}\r\nexport function parseLocalDatetime(s: string): Date {\r\n  const [date, time] = s.split('T');\r\n  const [y, m, d] = date.split('-').map(Number);\r\n  const [hh = 0, mm = 0] = (time ?? '00:00').split(':').map(Number);\r\n  return new Date(y, (m ?? 1) - 1, d ?? 1, hh, mm, 0, 0);\r\n}\r\nexport function humanizeDelta(deadline: Date): { label: string; isOverdue: boolean } {\r\n  const now = Date.now();\r\n  const ms = deadline.getTime() - now;\r\n  const abs = Math.abs(ms);\r\n  const mins = Math.floor(abs / 60000);\r\n  const days = Math.floor(mins / (60 * 24));\r\n  const hours = Math.floor((mins % (60 * 24)) / 60);\r\n  const minutes = mins % 60;\r\n  const core = days > 0 ? `${days}d ${hours}h ${minutes}m` : hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;\r\n  return ms < 0 ? { label: `Overdue by ${core}`, isOverdue: true } : { label: `${core} remaining`, isOverdue: false };\r\n}","'use client';\r\n\r\nimport type { Obligation } from '@/lib/rules';\r\nimport { formatLocalDateTime, humanizeDelta } from '@/lib/datetime';\r\nimport { useMounted } from '@/lib/hooks';\r\n\r\ntype Props = { obligations: Obligation[] };\r\n\r\nexport default function TimelineResults({ obligations }: Props) {\r\n  const mounted = useMounted();\r\n\r\n  if (!obligations.length) {\r\n    return (\r\n      <div className=\"text-sm text-brx-text-body\">\r\n        No example obligations matched this scenario.\r\n        <div className=\"mt-4 rounded-md bg-gray-50 p-3 text-xs text-brx-text-body\">\r\n          This is a simplified, illustrative demo only and <strong>not legal advice</strong>.\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const mostUrgent = obligations[0];\r\n  const urgentDelta = mounted ? humanizeDelta(mostUrgent.deadline) : null;\r\n\r\n  const badge = urgentDelta\r\n    ? urgentDelta.isOverdue\r\n      ? 'bg-red-100 text-red-700 border-red-200'\r\n      : 'bg-brx-blue/10 text-brx-blue border-brx-blue/20'\r\n    : 'bg-gray-100 text-brx-text-body border-gray-200';\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"rounded-lg border border-brx-blue/20 bg-white p-4 shadow-sm\">\r\n        <div className=\"mb-2 flex items-center justify-between\">\r\n          <h2 className=\"font-heading text-sm font-medium text-brx-text-heading\">Most urgent obligation</h2>\r\n          <span className={`rounded-full border px-2 py-0.5 text-xs font-medium ${badge}`}>\r\n            {urgentDelta ? (urgentDelta.isOverdue ? 'Overdue' : 'Upcoming') : '—'}\r\n          </span>\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <div className=\"font-heading text-base font-semibold text-brx-navy\">{mostUrgent.name}</div>\r\n          <div className=\"text-sm text-brx-text-body\" suppressHydrationWarning>\r\n            Deadline:{' '}\r\n            {mounted ? formatLocalDateTime(mostUrgent.deadline) : mostUrgent.deadline.toISOString()}\r\n            {mounted && urgentDelta ? ` (${urgentDelta.label})` : ''}\r\n          </div>\r\n          <div className=\"text-xs text-brx-text-body\">Framework: <span className=\"font-medium text-brx-blue\">{mostUrgent.framework}</span></div>\r\n          <p className=\"mt-2 text-sm text-brx-text-body\">{mostUrgent.description}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full text-left text-sm\">\r\n          <thead className=\"text-xs uppercase tracking-wide text-brx-text-body\">\r\n            <tr>\r\n              <th className=\"border-b border-gray-200 px-3 py-2\">Requirement</th>\r\n              <th className=\"border-b border-gray-200 px-3 py-2\">Framework</th>\r\n              <th className=\"border-b border-gray-200 px-3 py-2\">Notify Who</th>\r\n              <th className=\"border-b border-gray-200 px-3 py-2\">Deadline</th>\r\n              <th className=\"border-b border-gray-200 px-3 py-2\">Time window</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {obligations.map((o) => {\r\n              const d = mounted ? humanizeDelta(o.deadline) : null;\r\n              return (\r\n                <tr key={o.id} className=\"align-top hover:bg-gray-50 transition-colors\">\r\n                  <td className=\"border-b border-gray-200 px-3 py-3\">\r\n                    <div className=\"font-medium text-brx-text-heading\">{o.name}</div>\r\n                    <div className=\"text-xs text-brx-text-body\">{o.description}</div>\r\n                  </td>\r\n                  <td className=\"border-b border-gray-200 px-3 py-3 text-brx-blue font-medium\">{o.framework}</td>\r\n                  <td className=\"border-b border-gray-200 px-3 py-3 text-brx-text-body\">{o.notifyWho}</td>\r\n                  <td className=\"border-b border-gray-200 px-3 py-3\" suppressHydrationWarning>\r\n                    <div className=\"text-brx-text-heading\">{mounted ? formatLocalDateTime(o.deadline) : o.deadline.toISOString()}</div>\r\n                    <div className={`text-xs ${d?.isOverdue ? 'text-red-600 font-medium' : 'text-brx-text-body'}`}>\r\n                      {mounted && d ? d.label : '—'}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"border-b border-gray-200 px-3 py-3 text-brx-text-body\">{o.windowHours} hours from discovery</td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <p className=\"text-xs text-brx-text-body\">\r\n        This is a simplified, illustrative demo only and not legal advice.\r\n      </p>\r\n    </div>\r\n  );\r\n}","import { addHours, truncateToMinute } from './datetime';\r\n\r\nexport type IncidentType = 'ransomware' | 'lost_device' | 'vendor_breach' | 'phishing';\r\nexport type DataCategory = 'customer_pii' | 'health_phi' | 'payment_data' | 'employee_data';\r\nexport type Region = 'eu' | 'california' | 'new_york' | 'us_other';\r\n\r\nexport type IncidentInput = {\r\n  discoveredAt: Date;\r\n  incidentType: IncidentType;\r\n  dataCategories: DataCategory[];\r\n  regions: Region[];\r\n};\r\n\r\nexport type Obligation = {\r\n  id: string;\r\n  name: string;\r\n  framework: string;\r\n  notifyWho: string;\r\n  windowHours: number;\r\n  deadline: Date;\r\n  description: string;\r\n};\r\n\r\ntype Rule = {\r\n  id: string;\r\n  name: string;\r\n  framework: string;\r\n  notifyWho: string;\r\n  windowHours: number;\r\n  description: string;\r\n  applies: (incident: IncidentInput) => boolean;\r\n};\r\n\r\nconst RULES: Rule[] = [\r\n  {\r\n    id: 'gdpr-72h',\r\n    name: 'Notify Supervisory Authority (GDPR)',\r\n    framework: 'GDPR',\r\n    notifyWho: 'EU Supervisory Authority',\r\n    windowHours: 72,\r\n    description:\r\n      'Report certain personal data breaches without undue delay and, where feasible, within 72 hours.',\r\n    applies: (i) =>\r\n      i.regions.includes('eu') &&\r\n      (i.dataCategories.includes('customer_pii') ||\r\n        i.dataCategories.includes('employee_data') ||\r\n        i.dataCategories.includes('payment_data')),\r\n  },\r\n  {\r\n    id: 'ccpa-30d',\r\n    name: 'Notify Affected Consumers (CCPA/CPRA)',\r\n    framework: 'CCPA/CPRA',\r\n    notifyWho: 'California consumers + AG where applicable',\r\n    windowHours: 30 * 24,\r\n    description: 'Consumer notification obligations may apply depending on the nature of the breach.',\r\n    applies: (i) => i.regions.includes('california') && i.dataCategories.includes('customer_pii'),\r\n  },\r\n  {\r\n    id: 'hipaa-60d',\r\n    name: 'Notify Individuals (HIPAA Breach Rule)',\r\n    framework: 'HIPAA',\r\n    notifyWho: 'Affected individuals; HHS; media (where applicable)',\r\n    windowHours: 60 * 24,\r\n    description: 'Notification of unsecured PHI breaches to individuals and regulators.',\r\n    applies: (i) => i.dataCategories.includes('health_phi'),\r\n  },\r\n  {\r\n    id: 'nyshield-30d',\r\n    name: 'Notify Affected New York Residents (NY SHIELD)',\r\n    framework: 'NY SHIELD',\r\n    notifyWho: 'NY residents; possibly NYAG and agencies',\r\n    windowHours: 30 * 24,\r\n    description: 'State-level consumer notification obligations for certain data breaches.',\r\n    applies: (i) => i.regions.includes('new_york') && i.dataCategories.includes('customer_pii'),\r\n  },\r\n  {\r\n    id: 'vendor-24h',\r\n    name: 'Notify Customer per Vendor Contract',\r\n    framework: 'Contractual',\r\n    notifyWho: 'Upstream customer / DPA contact',\r\n    windowHours: 24,\r\n    description: 'Contractual clause requiring notice of vendor incidents within a short window.',\r\n    applies: (i) => i.incidentType === 'vendor_breach',\r\n  },\r\n];\r\n\r\nexport const DEFAULT_INCIDENT_INPUT: IncidentInput = {\r\n  // Why: stabilize seconds to avoid minute-boundary mismatches.\r\n  discoveredAt: truncateToMinute(new Date()),\r\n  incidentType: 'ransomware',\r\n  dataCategories: ['customer_pii'],\r\n  regions: ['eu'],\r\n};\r\n\r\nexport function getMatchedObligations(incident: IncidentInput): Obligation[] {\r\n  const matched = RULES.filter((r) => r.applies(incident)).map<Obligation>((r) => ({\r\n    id: r.id,\r\n    name: r.name,\r\n    framework: r.framework,\r\n    notifyWho: r.notifyWho,\r\n    windowHours: r.windowHours,\r\n    deadline: addHours(incident.discoveredAt, r.windowHours),\r\n    description: r.description,\r\n  }));\r\n  matched.sort((a, b) => a.deadline.getTime() - b.deadline.getTime());\r\n  return matched;\r\n}"],"names":["module","exports","require","vendored","React","AppRouterContext","ReactServerDOMTurbopackClient","HooksClientContext","ServerInsertedHtml","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime"],"mappings":"6CAAAA,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK,8BCF9BJ,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,QAAW,CAACE,gBAAgB,8BCFvCL,GAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,YAAY,CAAEG,6BAA6B,8BCFtDN,GAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,QAAW,CAACI,kBAAkB,+BCFzCP,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,QAAW,CAACK,kBAAkB,8sBCwBjCR,GAAOC,OAAO,CAAGC,EAAQ,CAAA,CAAA,IAAA,iCC1BjCF,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,YAAY,CAAEY,eAAe,4CCGxC,EAAA,EAAA,CAAA,CAAA,OCYO,SAAS,EAAoB,CAAO,EACzC,OAAO,IAAI,KAAK,cAAc,MAAC,EAAW,CACxC,KAAM,UACN,MAAO,QACP,IAAK,UACL,KAAM,UACN,OAAQ,SACV,GAAG,MAAM,CAAC,EACZ,CAqBO,SAAS,EAAc,CAAc,EAC1C,IAAM,EAAM,KAAK,GAAG,GACd,EAAK,EAAS,OAAO,GAAK,EAE1B,EAAO,KAAK,KAAK,CADX,AACY,KADP,GAAG,CAAC,GACS,KACxB,EAAO,KAAK,KAAK,CAAC,EAAQ,KAAK,AAAN,CACzB,CADiC,CACzB,KAAK,KAAK,CAAE,EAAQ,KAAD,AAAM,AAAO,EAAL,EACnC,EAAU,EAAO,GAEjB,EACJ,EAAO,EACH,CAAA,EAAG,EAAK,EAAE,EAAE,EAAM,EAAE,EAAE,EAAQ,CAAC,CAAC,CAChC,EAAQ,EACR,CAAA,EAAG,EAAM,EAAE,EAAE,EAAQ,CAAC,CAAC,CACvB,CAAA,EAAG,EAAQ,CAAC,CAAC,CAEnB,OAAO,EAAK,EACR,CAAE,MAAO,CAAC,WAAW,EAAE,EAAA,CAAM,CAAE,WAAW,CAAK,EAC/C,CAAE,MAAO,CAAA,EAAG,EAAK,UAAU,CAAC,CAAE,WAAW,CAAM,CACrD,CChDA,IAAM,EAA2D,CAC/D,CAAE,MAAO,aAAc,MAAO,YAAa,EAC3C,CAAE,MAAO,cAAe,MAAO,aAAc,EAC7C,CAAE,MAAO,gBAAiB,MAAO,eAAgB,EACjD,CAAE,MAAO,WAAY,MAAO,UAAW,EACxC,CAEK,EAAyD,CAC7D,CAAE,MAAO,eAAgB,MAAO,cAAe,EAC/C,CAAE,MAAO,aAAc,MAAO,YAAa,EAC3C,CAAE,MAAO,eAAgB,MAAO,cAAe,EAC/C,CAAE,MAAO,gBAAiB,MAAO,eAAgB,EAClD,CAEK,EAAqD,CACzD,CAAE,MAAO,YAAa,MAAO,IAAK,EAClC,CAAE,MAAO,yBAA0B,MAAO,YAAa,EACvD,CAAE,MAAO,uBAAwB,MAAO,UAAW,EACnD,CAAE,MAAO,aAAc,MAAO,UAAW,EAC1C,CAEc,SAAS,EAAa,OAAE,CAAK,CAAE,UAAQ,CAAS,cDTvD,EACA,EACA,EACA,ICQA,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EACpD,CDdsC,CAAO,CCcnB,EAAM,YAAY,CDbxC,EAAO,AAAD,GAAe,OAAO,GAAG,QAAQ,CAAC,EAAG,OACpC,EAAE,WAAW,KACf,EAAI,EAAE,QAAQ,GAAK,KACnB,EAAI,EAAE,OAAO,MACb,EAAI,EAAE,QAAQ,IACnB,EAAK,EAAI,EAAE,UAAU,IACpB,CAAA,EAAG,EAAK,CAAC,EAAE,EAAG,CAAC,EAAE,EAAG,CAAC,EAAE,EAAG,CAAC,EAAE,EAAA,CAAI,GCSlC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAC9C,EAAM,YAAY,EAEd,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAClD,IAAI,IAAI,EAAM,cAAc,GAExB,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,IAAI,IAAI,EAAM,OAAO,GAEnE,EAAe,CAAA,EAAA,EAAA,OAAA,AAAO,EAC1B,IAAM,CAAC,CACL,aAAc,ADhBb,SAAS,AAAmB,CAAS,EAE1C,GAAM,CAAC,EAAM,EAAK,CAAG,EAAE,KAAK,CAAC,KACvB,CAAC,EAAG,EAAG,EAAE,CAAG,EAAK,KAAK,CAAC,KAAK,GAAG,CAAC,QAChC,CAAC,EAAK,CAAC,CAAE,EAAK,CAAC,CAAC,CAAG,CAAC,GAAQ,OAAA,CAAO,CAAE,KAAK,CAAC,KAAK,GAAG,CAAC,QAE1D,OAAO,IAAI,KAAK,EAAG,CAAC,IAAK,CAAC,CAAI,EAAG,GAAK,EAAG,EAAI,EAAI,EAAG,EACtD,ECSuC,gBACjC,EACA,eAAgB,MAAM,IAAI,CAAC,GAC3B,QAAS,MAAM,IAAI,CAAC,GACtB,CAAC,CACD,CAAC,EAAiB,EAAc,EAAgB,EAAQ,EAG1D,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,EAAS,EACX,EAAG,CAAC,EAAc,EAAS,EAE3B,IAAM,EAAY,CAChB,EACA,EACA,KAEA,IAAM,EAAO,IAAI,IAAI,GACjB,EAAK,GAAG,CAAC,GAAM,EAAK,MAAM,CAAC,GAC1B,EAAK,GAAG,CAAC,GACd,EAAO,EACT,EAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,UAAU,YACV,SAAU,AAAC,IACT,EAAE,cAAc,GAChB,EAAS,EACX,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2DAAkD,2BAGnE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,iBACL,UAAU,6JACV,MAAO,EACP,SAAU,AAAC,GAAM,EAAmB,EAAE,MAAM,CAAC,KAAK,OAItD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2DAAkD,kBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,UAAU,6JACV,MAAO,EACP,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,KAAK,WAE9C,EAAe,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAuB,MAAO,EAAI,KAAK,UACrC,EAAI,KAAK,EADC,EAAI,KAAK,QAO5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2DAAkD,kBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACZ,EAAa,GAAG,CAAE,AAAD,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAEC,UAAU,kKAEV,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,UAAU,kBACV,QAAS,EAAe,GAAG,CAAC,EAAI,KAAK,EACrC,SAAU,IACR,EAAU,EAAmB,EAAgB,EAAI,KAAK,IAGzD,EAAI,KAAK,GAXL,EAAI,KAAK,QAiBtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2DAAkD,qBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACZ,EAAe,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAEC,UAAU,kKAEV,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,UAAU,kBACV,QAAS,EAAQ,GAAG,CAAC,EAAI,KAAK,EAC9B,SAAU,IAAM,EAAU,EAAY,EAAS,EAAI,KAAK,IAEzD,EAAI,KAAK,GATL,EAAI,KAAK,QAetB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,UAAU,yHACX,sBAGD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sCAA6B,0CAMrD,CE9Je,SAAS,EAAgB,aAAE,CAAW,CAAS,EAC5D,IAAM,EDRD,ACQW,SDRF,EACd,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEvC,MADA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,IAAM,GAAW,GAAO,EAAE,EAC7B,CACT,ICME,GAAI,CAAC,EAAY,MAAM,CACrB,CADuB,KAErB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCAA6B,gDAE1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEAA4D,oDACxB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,qBAAyB,UAM1F,IAAM,EAAa,CAAW,CAAC,EAAE,CAC3B,EAAc,EAAU,EAAc,EAAW,QAAQ,EAAI,KAE7D,EAAQ,EACV,EAAY,SAAS,CACnB,yCACA,kDACF,iDAEJ,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wEACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,2BACvE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,oDAAoD,EAAE,EAAA,CAAO,UAC5E,EAAe,EAAY,SAAS,CAAG,UAAY,WAAc,SAGtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8DAAsD,EAAW,IAAI,GACpF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BAA6B,wBAAwB,CAAA,CAAA,YAAC,YACzD,IACT,EAAU,EAAoB,EAAW,QAAQ,EAAI,EAAW,QAAQ,CAAC,WAAW,GACpF,GAAW,EAAc,CAAC,EAAE,EAAE,EAAY,KAAK,CAAC,CAAC,CAAC,CAAG,MAExD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCAA6B,cAAW,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qCAA6B,EAAW,SAAS,MACxH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2CAAmC,EAAW,WAAW,SAI1E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yCACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,8DACf,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,gBACnD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,cACnD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,eACnD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,aACnD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAqC,qBAGvD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UACE,EAAY,GAAG,CAAC,AAAC,IAChB,IAAM,EAAI,EAAU,EAAc,EAAE,QAAQ,EAAI,KAChD,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAc,UAAU,yDACvB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,+CACZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6CAAqC,EAAE,IAAI,GAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA8B,EAAE,WAAW,MAE5D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wEAAgE,EAAE,SAAS,GACzF,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iEAAyD,EAAE,SAAS,GAClF,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,qCAAqC,wBAAwB,CAAA,CAAA,YACzE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAU,EAAoB,EAAE,QAAQ,EAAI,EAAE,QAAQ,CAAC,WAAW,KAC1G,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,QAAQ,EAAE,GAAG,UAAY,2BAA6B,qBAAA,CAAsB,UAC1F,GAAW,EAAI,EAAE,KAAK,CAAG,SAG9B,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,EAAE,WAAW,CAAC,6BAb9E,EAAE,EAAE,CAgBjB,UAKN,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,yEAKhD,CC5DA,IAAM,EAAgB,CACpB,CACE,GAAI,WACJ,KAAM,sCACN,UAAW,OACX,UAAW,2BACX,YAAa,GACb,YACE,kGACF,QAAS,AAAC,GACR,EAAE,OAAO,CAAC,QAAQ,CAAC,OAClB,EAAD,CAAG,cAAc,CAAC,QAAQ,CAAC,iBACzB,EAAE,cAAc,CAAC,QAAQ,CAAC,kBAC1B,EAAE,cAAc,CAAC,QAAQ,CAAC,eAAA,CAAe,AAC/C,EACA,CACE,GAAI,WACJ,KAAM,wCACN,UAAW,YACX,UAAW,6CACX,YAAa,IACb,CADkB,WACL,qFACb,QAAS,AAAC,GAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,eAAiB,EAAE,cAAc,CAAC,QAAQ,CAAC,eAChF,EACA,CACE,GAAI,YACJ,KAAM,yCACN,UAAW,QACX,UAAW,sDACX,YAAa,KAAK,AAClB,YAAa,wEACb,QAAS,AAAC,GAAM,EAAE,cAAc,CAAC,QAAQ,CAAC,aAC5C,EACA,CACE,GAAI,eACJ,KAAM,iDACN,UAAW,YACX,UAAW,2CACX,YAAa,IACb,CADkB,WACL,2EACb,QAAS,AAAC,GAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,aAAe,EAAE,cAAc,CAAC,QAAQ,CAAC,eAC9E,EACA,CACE,GAAI,aACJ,KAAM,sCACN,UAAW,cACX,UAAW,kCACX,YAAa,GACb,YAAa,iFACb,QAAS,AAAC,GAAyB,kBAAnB,EAAE,YAAY,AAChC,EACD,CAEY,EAAwC,CAEnD,aJlFO,CIkFO,GJlFH,KACT,CAF6B,CAAO,CImFP,IAAI,MJjF/B,WAAW,GACb,EAAE,QAAQ,GACV,EAAE,OAAO,GACT,EAAE,QAAQ,GACV,EAAE,UAAU,GACZ,EACA,GI4EF,aAAc,aACd,eAAgB,CAAC,eAAe,CAChC,QAAS,CAAC,KAAK,AACjB,EL9Ee,SAAS,IACtB,GAAM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EACtC,GAGI,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EACzB,IAAM,aKoFR,CATM,EAAU,EAAM,MAAM,CAAC,AAAC,GAAM,EAAE,OAAO,CAAC,AL3EhB,IK2E2B,GAAG,CAAa,AAAC,IAAM,cAAC,CAC/E,GAAI,EAAE,EAAE,CACR,KAAM,EAAE,IAAI,CACZ,UAAW,EAAE,SAAS,CACtB,UAAW,EAAE,SAAS,CACtB,YAAa,EAAE,WAAW,CAC1B,QAAA,EAAU,AJrGW,EIqGF,EJrGY,AIqGH,YAAY,CJrGP,EIqGS,EAAE,CJrGE,UIqGS,CJpGlD,IAAI,KAAK,EAAK,OAAO,GAAa,KAAR,AAAa,KAAK,CIqGjD,YAAa,EAAE,WAAW,AAC5B,CAAC,IACO,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,QAAQ,CAAC,OAAO,GAAK,EAAE,QAAQ,CAAC,OAAO,IACzD,GLpFL,CAAC,EAAS,EAGZ,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,sCACjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAO,EAAU,SAAU,MAG3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAgB,YAAa,QAItC","ignoreList":[0,1,2,3,4,5,6]}